@charset "UTF-8";

@import "../utilities/variables";
@import "../base/icons";
@import "../base/common";
@import "../base/print/print-book-typography";

// print common
%print-icon-before {
  font-family: 'Font Awesome 5 Free';
  font-weight: 900;
}
%print-component-border {
  border: 2px solid $slate-grey;
}
$print-component-border: 2px solid $slate-grey;
$print-component-border-thin: 1px solid $slate-grey;
$print-component-margin: 1.25rem;
$print-component-margin-sm: calc(#{$print-component-margin} / 2);
$print-component-padding: 1.25rem;
%print-text-highlight {
  border: 1px solid $slate-grey;
  padding: 0 2px;
}

html {
  font-size: 14px;
}

/* print preview */
#page-mod-book-print {
/*
  font-size: 1rem;
  color: $body-text;
  font-family: "Open Sans";
  margin: 0;
*/
  #page-content {
    max-width: 85%;
    margin: 0 auto;
    // single chapter book hide toc and first chapter title for print preview
    &.single-chapter-book {
      .toc-container,
      [class^="book_toc_"],
      .book_chapter h2:first-of-type {
        display: none;
      }
    }
    // add margin before absolutely positioned print button
    #maincontent {
      margin-bottom: $component-margin-bottom-lg;
    }
    .book {
      // chrome preview print book button
      .text-right {
        a.hidden-print {
          color: $white;
          position: relative;
          img {
            display: none;
          }
          // mimic button styles around print button
          // with print icon
          &::before,
          &::after {
            color: $midnight-blue;
            background-color: $white;
            border: 2px solid $midnight-blue;
            font-size: 18px;
            position: absolute;
            top: 0;
            left: 0;
            line-height: 22.5px;
          }
          &::before {
            @extend %print-icon-before;
            @include fa-content($fa-print);
            padding: 10px 8px 10px 12px;
            border-radius: 4px 0 0 4px;
            border-right: none;
          }
          &::after {
            content: "Print";
            font-family: "KingsBureauGrot";
            padding: 10px 12px 10px 0;
            border-radius: 0 4px 4px 0;
            left: 38px;
            border-left: none;
          }
          &:hover {
            &::before,
            &::after {
              color: white !important;
              background-color: $link-hover !important;
              border-color:$link-hover;
              transition: all 0.3s ease 0.1s;
            }
          }
        }
      }
      .book_title {
        // large margin to prevent overlap with print button
        h1:first-of-type {
          margin-top: 4rem;
        }
      }
      .book_info {
        & > .w-50 {
          width: 100%;
        }
        table {
          margin-bottom: 4.5rem;
          td {
            padding: 0;
            color: $body-text;
            // to allow both book info tables to line up
            &:first-child {
              width: 100px;
            }
          }
          tr td:nth-child(2) {
            padding-left: $component-padding;
          }
        }
      }
      // book description
      .book_description {
        .book_summary {
          text-align: left;
          margin: 0;
        }
      }
      // book table of contents
      [class^="book_toc_"] {
        page-break-after: always;
        page-break-before: auto;
        margin-bottom: $component-margin-bottom-xl;
        ul {
          margin-left: 0;
          li {
            margin-top: $component-margin-xs;
            list-style: none;
            ul {
              margin-left: $component-margin-bottom-lg;
            }
          }
        }
        & > a:first-child {
          display: none;
        }
      }
      // book chapters
      & > :last-child {
        .book_chapter {
          page-break-before: auto;
          &:not(:last-child) {
            margin-bottom: 4.5rem;
          }
          & > a:first-child {
            display: none;
          }
        }
      }
    }
  }

  // Typography
  h1, .h1,
  h2, .h2,
  h3, .h3,
  h4, .h4,
  h5, .h5,
  h6, .h6 {
    page-break-after: avoid;
    page-break-inside: avoid;
  }
  p a,
  li p a {
    position: relative;
    margin-right: $component-margin-xs;
    i.open-icon {
      display: none;
    }
    &::after {
      @extend %print-icon-before;
      @include fa-content($fa-link);
      position: absolute;
      font-size: 8px;
      margin-left: 1px;
    }
  }
  a {
    &.link-to-video {
      @extend %print-text-highlight;
      margin-right: 0;
      // to allow for link icon
      padding-right: 0.75rem;
    }
  }
  mark.text-highlight {
    @extend %print-text-highlight;
    background-color: transparent;
    line-height: 22px;
  }
  .blockquote,
  .quote-box {
    border: 2px solid $footer-dark;
    margin:0;
    margin-bottom: $component-margin;
    position: relative;
    padding: $component-padding;;
    & > :first-child {
      padding-left: 2.75rem;
      &::before {
        content: 'â€œ';
        color: $footer-dark;
        font-family: "KingsCaslonDisplay";
        font-size: 4.5rem;
        font-weight: 900;
        top: 2.5rem;
        position: absolute;
        left: $component-margin-sm;
      }
    }
    .quote-attribution {
      margin: 0;
      font-size: 1.2rem;
      font-family: "KingsBureauGrot";
    }
    .quote-body {
      font-size: 1rem;
      font-family: "Open Sans";
    }
  }
  figure {
    margin: 0 0 $component-margin 0;
    &.quote-box,
    &.blockquote {
      padding-left: 4rem;
      blockquote.quote-body {
        &::before {
          top: $component-margin-xs;
        }
        border: none;
        margin-bottom: $component-margin !important;
        padding: 0;
        // override theme styles
        p {
          padding: 0;
          font-size: 1rem;
        }
        & > :last-child {
          margin-bottom: 0;
        }
      }
    }
    figcaption {
      line-height: 1.5;
    }
  }

  // Bootstrap
  .container {
    width: auto;
  }
  .row {
    display: flex;
    flex-wrap: wrap;
    background-color: transparent;
    margin-left: -15px;
    margin-right: -15px;
  }
  .col,
  [class*="col-"] {
    flex-basis: 0;
    flex-grow: 1;
    margin-left: 15px;
    margin-right: 15px;
  }
  .col-auto {
    flex: 0 0 auto;
    width: auto;
  }
  .col-md-3 {
    flex: 0 0 25%;
    max-width: calc(25% - 30px);
  }
  .col-md-4 {
    flex: 0 0 33.3333%;
    max-width: calc(33.3333% - 30px);
  }
  .col-md-6 {
    flex: 0 0 50%;
    max-width: calc(50% - 30px);
  }
  .col-md-9 {
    flex: 0 0 75%;
    max-width: calc(75% - 30px);
  }
  .h-50 {
    height: 50% !important;
  }

  // Card
  .card {
    @extend %print-component-border;
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    border-radius: 0;
    margin-bottom: $component-margin;
    padding: $component-padding;
    .card-body {
      background-color: transparent;
      padding: 0;
      flex: 1;
      .card-title,
      h3, h4, h5, h6 {
        margin-bottom: 0.625rem;
      }
      & > :last-child {
        margin-bottom: 0;
      }
    }
    img {
      margin: 0 $component-margin 0 0;
      width: 330px;
      &.img-top {
        width: 100%;
        height: 100%;
        margin: 0 0 $component-margin 0;
      }
    }
    & > img {
      align-self: flex-start;
    }
    &.img-right {
      & > .filter-ally-wrapper,
      & > img {
        order: 2;
        margin: 0 0 0 $component-margin;
      }
      & > .filter-ally-wrapper > img {
        margin: 0;
        height: auto;
      }
    }
  }
  // Card deck
  .card-deck {
    display: flex;
    flex-flow: row wrap;
    margin: 0;
    .card {
      display: block;
      flex: 1 0 0%;
      margin: 0 $component-margin-sm $component-margin 0 !important;
      &:last-child {
        margin: 0 0 $component-margin $component-margin-sm !important;
      }
      img {
        width: 100%;
        height: auto;
        margin-bottom: $print-component-margin;
      }
    }
  }
  // Float box (2.5.2+)
  .float-box {
    display: flex;
    flex-direction: row;
    margin-bottom: $component-margin;
    &.img-right {
      & > .filter-ally-wrapper,
      & > img,
      & > figure,
      & > .img-container {
        order: 2;
        margin: 0 0 0 $component-margin;
      }
      & > .filter-ally-wrapper > img {
        margin: 0;
        height: auto;
      }
      &.small-image,
      &.img-small,
      &.small-img {
        & > .filter-ally-wrapper,
        & > img {
          margin: 0 0 0 $component-margin-sm;
        }
      }
      & > div:not(.img-container) {
        order: 1;
      }
    }
    & > .filter-ally-wrapper,
    & > img,
    & > figure,
    & > .img-container {
      margin: 0 $component-margin 0 0;
      flex-shrink: 0;
      align-self: flex-start;
      // for firefox
      @-moz-document url-prefix() {
        flex: max-content;
      }
    }
    figure,
    // to maintain old .img-container class
    .img-container {
      width: min-content;
    }
    & > .filter-ally-wrapper > img {
      margin: 0;
    }
    &.small-image,
    &.img-small,
    &.small-img {
      & > .filter-ally-wrapper,
      & > img {
        margin: 0 $component-margin-sm 0 0;
      }
      img {
        width: 100px;
      }
    }
    // override theme max-width 100%;
    img {
      max-width: 310px !important;
    }
    & > div:not(.img-container) {
      order: 2;
    }
    h3, h4, h5, h6 {
      margin-bottom: 0.625rem;
    }
  }

  // Carousel (2.3-)
  .carousel {
    &::before {
      display: none;
    }
    .carousel-indicators {
      display: none;
    }
    .carousel-item {
      display: block;
      margin-bottom: $component-margin;
      padding: 0;
      img {
        max-width: 100%;
      }
      .carousel-caption {
        @extend %print-component-border;
        position: static;
        max-width: calc(100% - 2.5rem - 4px);
        padding: $component-padding;
        background-color: transparent !important;
        h3, h4, h5, h6 {
          font-size: 1.125rem;
          color: $body-text;
        }
        & > * {
          color: $body-text;
          margin-bottom: $component-margin;
          &:last-child {
            margin-bottom: 0;
          }
        }
      }
    }
    .carousel-control-prev,
    .carousel-control-next {
      display: none;
    }
  }
  // New Carousel (2.4+)
  .new-carousel {
    width: 100% !important;
    .nc-gallery {
      list-style-type: none;
      counter-reset: newcarousel;
      display: flex;
      flex-wrap: wrap;
      margin: 0 calc(-#{$component-margin} / 2) 0 calc(-#{$component-margin} / 2) !important;
      & > li {
        list-style-type: none;
        border: $print-component-border-thin;
        margin: 0 calc(#{$component-margin} / 2) $component-margin calc(#{$component-margin} / 2);
        padding: $component-padding 0;
        display: inline-block;
        width: calc(50% - #{$component-margin} - 2px);
        counter-increment: newcarousel;
        &::before {
          content: counter(newcarousel);
          color: $body-text;
          font-weight: bold;
          vertical-align: top;
          margin-left: $component-margin;
        }
        figure {
          margin: 0;
          padding: 0 $component-padding;
          figcaption :last-child {
            margin-bottom: 0;
          }
        }
        img {
          max-width: 100%;
          margin-bottom: $component-margin-bottom-sm;
        }
      }
    }
    .nc-buttons {
      display: none;
    }
  }

  // Collapse
  .collapse-container {
    margin-bottom: $component-margin;
    .collapse-card {
      border-bottom: 2px solid $pearl-grey;
      padding: $component-padding;
      padding-left: 4rem;
      &:first-child {
        border-top: 2px solid $pearl-grey;
      }
      .collapse-header {
        button {
          margin: 0;
          padding: 0;
          &:hover {
            text-decoration: none;
            cursor: text;
          }
          h3, h4, h5, h6 {
            position: relative;
            text-align: left;
            &::before {
              @extend %print-icon-before;
              @include fa-content($fa-angle-down);
              color: $slate-grey;
              position: absolute;
              left: -2.5rem;
              top: -6px;
              font-size: 24px;
            }
          }
        }
      }
      .collapse-body {
        & > :last-child {
          margin: 0;
        }
      }
    }
  }

  // Embed audio and video
  .audio-container {
    position: absolute;
    display: inline-block;
    margin-bottom: $component-margin;
    .audio-top {
      display: flex;
      .audio-image {
        width: 80px;
        height: 80px;
        margin-right: $component-margin;
        border-radius: 6px;
        border: 1px solid $rules-and-outlines;
      }
      .audio-info {
        display: flex;
        flex-direction: column;
        justify-content: center;
        .audio-speaker,
        .audio-title {
          font-size: 1.125rem;
          line-height: normal;
        }
        .audio-speaker {
          margin-bottom: $component-margin-sm;
        }
        .audio-title {
          margin: 0;
        }
      }
    }
    & + * {
      margin-top: 98px;
      // add default component marign if no transcript container is present
      &:not(.transcript-container) {
        margin-top: 122px
      }
    }
  }
  .embed-responsive {
    display: none;
  }

  // Footnotes
  // v2.6-
  .book-content {
    counter-reset: footnotes;
  }
  a[aria-describedby="footnote-label"]{
    content: counter(footnotes);
    vertical-align: super;
    font-size: 0.75em;
    font-weight: bold;
    margin: 0 0 0 4px;
    text-decoration: underline;
    &::after {
      display: none;
    }
  }
  aside.footnotes {
    border-top: $print-component-border-thin;
    padding-top: $component-padding;
  }
  // v2.7+
  // supported list style types
  // disc and none ref links will display as decimal
  $list-style-types: [
    decimal, // a number (default)
    disc, // a filled circle
    lower-latin, // a, b, c, d, etc.
    lower-roman, // i, ii, iii, iv, etc.
    none, // no marker shown
    upper-latin, // A, B, C, D, etc.
    upper-roman // I, II, III, IV, etc.
  ];
  @mixin list-style-types {
    @each $type in $list-style-types {
      &.lst-#{$type} {
        .footnotes-body {
          .quote::after {
            @if $type == disc or $type == none {
              content: counter(quote, decimal);
            } @else {
              content: counter(quote, $type);
            }
          }
        }
        .footnotes-footer {
          ol {
            list-style: $type;
          }
        }
      }
    }
  }
  .footnotes-article {
    @include list-style-types;
    margin-bottom: $component-margin;
    // reference list
    .footnotes-body {
      counter-reset: quote;
      .quote {
        counter-increment: quote;
        text-decoration: underline;
        // ref styled just incase JS fails to move to footer
        .ref {
          color: $slate-grey;
          font-style: italic;
          &::before {
            content: " [";
          }
          &::after {
           content: "]";
          }
        }
        &::after {
          content: counter(quote);
          text-decoration: underline;
          font-size: 0.875rem;
          vertical-align: top;
          position: relative;
          top: -4px;
          padding: 4px;
          border-radius: 4px
        }
      }
    }
    .footnotes-footer {
      border-top: 1px solid $rules-and-outlines;
      padding: $component-margin 0 0 0;
      margin: $component-margin 0 0 0;
      ol {
        margin-bottom: 0 !important;
        li {
          .ref {
            line-height: 1.5;
            word-break: break-all;
          }
          &::marker {
            font-size: 14px;
          }
        }
      }
    }
  }

  // Images
  figure {
    margin-bottom: $component-margin;
    figcaption, .caption {
      max-width: none;
    }
    & > :not(figcaption),
    & > .img-scroll, & > .image-scroll {
      margin-bottom: 0 !important;
    }
  }
  .full-width-img, .img-full-width,
  .center-img, .img-center,
  .circular-img, .img-circular,
  .img-scroll, .image-scroll {
    margin-bottom: $component-margin;
    figcaption, .caption {
      max-width: none;
    }
  }
  .full-width-img, .img-full-width,
  .img-scroll, .image-scroll {
    img {
      width: 100%;
      height: auto;
    }
  }
  .center-img,
  .img-center {
    text-align: center;
  }
  .circular-img,
  .img-circular {
    border-radius: 50%;
    max-width: 100%;
  }
  .image-scroll,
  .img-scroll {
    margin-top: 54px;
    position: relative;
    &::before {
      @extend %print-icon-before;
      @include fa-content($fa-image);
      color: $body-text;
      position: absolute;
      top: -36px;
      left: 0;
      font-size: 28px;
    }
    &::after {
      content: "This is a wide image. Return to the webpage to view further details.";
      position: absolute;
      top: -36px;
      left: 36px;
    }
  }
  .screenshot,
  .img-bordered {
    border: $print-component-border-thin;
  }

  // Info box
  .editing-help-box {
    display: none;
  }
  .definition-box,
  .alert-caution,
  .alert-instructional,
  .feedback-box,
  .learning-outcome-box,
  .media-box,
  .reading-box,
  .journal-box,
  .shared-box,
  .files-box {
    & > :first-child::before {
      @extend %print-icon-before;
      font-size: 1.2rem;
      position: absolute;
      top: 1.4rem;
      left: $component-margin;
      color: $slate-grey;
    }
  }
  .definition-box > :first-child::before {
    @include fa-content($fa-bookmark);
    padding: 0 6px;
  }
  .alert {
    color: $body-text;
  }
  .alert-caution > :first-child::before {
    @include fa-content($fa-exclamation-triangle);
    padding: 0 3px;
  }
  .alert-instructional > :first-child::before {
    @include fa-content($fa-comments);
    padding: 0 3px;
  }
  .feedback-box > :first-child::before {
    @include fa-content($fa-comments-alt);
    padding: 0 4px;
    top: 1.5rem;
  }
  .learning-outcome-box > :first-child::before {
    @include fa-content($fa-trophy);
    padding: 0 3px;
    top: 1.45rem;
  }
  .media-box > :first-child::before {
    @include fa-content($fa-play-circle);
    padding: 0 4px;
  }
  .journal-box > :first-child::before {
    @include fa-content($fa-edit);
    padding: 0 3px;
  }
  .reading-box > :first-child::before {
    @include fa-content($fa-book-reader);
    padding: 0 4px;
  }
  .shared-box > :first-child::before {
    @include fa-content($fa-users);
    padding: 0 4px;
  }
  .files-box > :first-child::before {
    @include fa-content($fa-folder-open);
    padding: 0 3px;
  }
  .definition-box,
  .alert-caution,
  .alert-instructional,
  .feedback-box,
  .key-concept-box,
  .learning-outcome-box,
  .media-box,
  .reading-box,
  .journal-box,
  .shared-box,
  .files-box {
    border: 2px solid $table-border;
    padding: $component-padding;
    padding-left: 4rem;
    margin-bottom: $component-margin;
    position: relative;
    h3, h4, h5, h6 {
      font-size: 1.2rem;
    }
    & > div > :last-child {
      margin-bottom: 0;
    }
  }
  .alert-caution,
  .alert-instructional {
    background-color: $block-header;
  }
  .key-concept-box {
    @extend %print-component-border;
    padding: $component-padding;
    font-weight: bold;
    background-color: $block-header;
  }
  .learning-outcome-box ol,
  .learning-outcome-box ul {
     margin-bottom: 0;
  }

  // Process
  .process-container {
    .process-card {
      img {
        width: 130px;
        height: 130px;
        object-fit: cover;
      }
    }
    .connector-container {
      text-align: center;
      margin-bottom: $component-margin;
      .icon.arrow-down::before,
      .icon.arrow-up::after {
        @extend %print-icon-before;
        @include fa-content($fa-arrow-down);
        font-size: 30px;
        margin: 10px;
      }
      .icon.arrow-up::after {
        @include fa-content($fa-arrow-up);
      }
      .icon.relate {
        border-right: 3px solid $black !important;
        height: 40px;
        width: 50%;
        margin: 10px;
      }
    }
  }

  // Table
  // table variables
  $print-table-border: 2px solid $table-border;

  // mixin to add borders around and bg to individual row/col
  @mixin table-single-row-col-border {
    @for $i from 1 through 50 {
      &.row-#{$i}-border {
        tr:nth-child(#{$i}) td {
          border-top: $print-table-border !important;
          border-bottom: $print-table-border !important;
          &:first-child {
            border-left: $print-table-border !important;
          }
          &:last-child {
            border-right: $print-table-border !important;
          }
        }
      }
      // if no numerical value after background
      &.row-#{$i}-background {
        tr:nth-child(#{$i}) td {
          background-color: map-get($table-bg-colors, 1);
        }
      }
      &.row-#{$i}-border-background {
        @extend .row-#{$i}-border;
        tr:nth-child(#{$i}) td {
          background-color: map-get($table-bg-colors, 1);
        }
      }
      //map to table-bg-colors
      @each $bg-num, $hex in $table-bg-colors {
        &.row-#{$i}-background-#{$bg-num} {
          tr:nth-child(#{$i}) td {
            background-color: $hex;
          }
        }
        &.row-#{$i}-border-background-#{$bg-num} {
          @extend .row-#{$i}-border;
          tr:nth-child(#{$i}) td {
            background-color: $hex;
          }
        }
      }
      &.col-#{$i}-border {
        tr {
          td:nth-child(#{$i}) {
            border-left: $print-table-border !important;
            border-right: $print-table-border !important;
          }
          &:first-child {
           td:nth-child(#{$i}) {
              border-top: $print-table-border !important;
            }
          }
          &:last-child {
           td:nth-child(#{$i}) {
              border-bottom: $print-table-border !important;
            }
          }
        }
      }
      // if no numerical value after background
      &.col-#{$i}-background {
        tr {
          td:nth-child(#{$i}) {
            background-color: map-get($table-bg-colors, 1);
          }
        }
      }
      &.col-#{$i}-border-background {
        @extend .col-#{$i}-border;
        tr {
          td:nth-child(#{$i}) {
            background-color: map-get($table-bg-colors, 1);
          }
        }
      }
      //map to table-bg-colors
      @each $bg-num, $hex in $table-bg-colors {
        &.col-#{$i}-background-#{$bg-num} {
          tr {
            td:nth-child(#{$i}) {
              background-color: $hex;
            }
          }
        }
        &.col-#{$i}-border-background-#{$bg-num} {
          @extend .col-#{$i}-border;
          tr {
            td:nth-child(#{$i}) {
              background-color: $hex;
            }
          }
        }
      }
    }
  }
  // mixin to add borders to mimic divider for row/col
  @mixin table-divider {
    @for $i from 1 through 50 {
      &.row-#{$i}-divider {
        tr:nth-child(#{$i}) td {
          border-bottom: $print-table-border !important;
        }
      }
      &.col-#{$i}-divider {
        tr {
          td:nth-child(#{$i}) {
            border-right: $print-table-border !important;
          }
        }
      }
    }
  }
  // define table highlight background colours
  $table-bg-colors: (
    1: #FCEAB7 !important, // yellow 30%
    2: #A2E6F4 !important, // sky-blue 37%
    3: #F5B6B3 !important, // red 33%
    4: #FFA375 !important // orange 58%
  );

  table {
    margin-bottom: $component-margin;
    border-collapse: collapse;
    border-spacing: 0;
    border-radius: 0;
    &.no-borders,
    &.outer-borders-only {
      tr td {
        border: none;
      }
    }
    &.default-width {
      width: auto;
    }
    &.line-associated-content {
      &.with-line-numbers {
        tr {
          pre {
            padding-left: 26px;
            text-indent: -26px;
          }
        }
      }
      tr {
        &:not(:first-child):not(:last-child) {
          td {
            padding-top: 0;
            padding-bottom: 0;
          }
        }
        pre {
          margin: 0;
          padding: 0;
          font-size: 1rem;
          line-height: normal;
          border: none;
          word-break: break-word;
        }
        &:first-child {
          td {
            padding-bottom: 0;
          }
        }
        &:last-child {
          td {
            padding-top: 0;
          }
        }
      }
    }
    &.no-borders {
      td {
        border: none !important;
      }
    }
    @include table-single-row-col-border;
    @include table-divider;
    &.outer-borders-only {
      thead {
        border: $print-table-border;
        th {
          border: none !important;
        }
      }
      &.background {
        td {
          background-color: $block-background;
        }
      }
    }
    &.outer-borders-only,
    &.table-bordered {
      border: $print-table-border;
      border-radius: 0;
      border-collapse: collapse;
    }
    &.table-bordered {
      th,
      td {
        border: $print-table-border;
      }
      th {
        background-color: $block-header;
        color: $headings;
      }
      td {
        color: $body-text;
      }
    }
    &.table-diagonal-split {
      .split-cell {
        background: linear-gradient(to top right,
        $block-header 49%,
        $rules-and-outlines 49%,
        $rules-and-outlines 51%,
        $block-header 51%);
        line-height: 1;
        .top {
          margin-left: 120px;
          text-align: right;
        }
        .bottom {
          margin-right: 120px;
          text-align: left;
        }
      }
      th {
        vertical-align: top;
        line-height: 1;
      }
    }
    &.table-highlight {
      .highlight-cell {
        &.border {
          border: 4px solid $reflex-blue !important;
        }
        &.border-t, &.border-tr, &.border-trb, &.border-trl, &.border-tb, &.border-tbl, &.border-tl {
          border-top: 4px solid $reflex-blue !important;
        }
        &.border-b, &.border-tb, &.border-trb, &.border-tbl, &.border-rb, &.border-rbl, &.border-bl {
          border-bottom: 4px solid $reflex-blue !important;
        }
        &.border-r, &.border-tr, &.border-trb, &.border-trl, &.border-rb, &.border-rbl, &.border-rl {
          border-right: 4px solid $reflex-blue !important;
        }
        &.border-l, &.border-tl, &.border-trl, &.border-tbl, &.border-rl, &.border-rbl, &.border-bl {
          border-left: 4px solid $reflex-blue !important;
        }
        &.background {
          background-color: map-get($table-bg-colors, 1);
        }
        @each $index, $background-color in $table-bg-colors {
          &.background-#{$index} {
            background-color: $background-color;
          }
        }
      }
    }
    &.text-align-right {
      td {
        text-align: right;
      }
    }
    caption {
      font-size: 1rem;
      line-height: normal;
      font-weight: normal;
      caption-side: bottom !important;
      margin-top: $component-margin-xs;
    }
  }
  .table-scroll {
    position: relative;
    margin-top: 84px;
    &::before {
      @extend %print-icon-before;
      @include fa-content($fa-arrows-alt-h);
      color: $body-text;
      position: absolute;
      top: -66px;
      left: 0;
      font-size: 28px;
    }
    &::after {
      content: "This is a wide table and some information may be excluded in print.\00000a Please return to the webpage to check for more details.";
      position: absolute;
      top: -66px;
      left: 36px;
      white-space: pre-wrap;
    }
  }

  // Timeline (v2.4-)
  .timeline-container {
    margin-top: calc(25px - 2.5rem);
    .row,
    .col {
      margin: 0 !important;
    }
    .col-auto {
      flex-direction: column;
    }
  }
  .timeline-row {
    .col.border-right {
      border-right: $print-component-border;
    }
    .timeline-badge-pill {
      border-radius: 50%;
      border: 2px solid $slate-grey;
      height: calc(1.25rem - 2px);
      width: 1.25rem;
      padding: 0;
      padding-top: 2px;
      background-color: transparent;
      position: relative;
      &::after {
        content: "";
        position: absolute;
        display: block;
        top: 50%;
        left: calc(100% + 2px);
        border-top: $print-component-border-thin;
        border-bottom: $print-component-border-thin;
        width: 1rem;
      }
    }
    &:last-child .timeline-content .timeline-card {
      margin-bottom: $component-margin;
    }
  }
  .timeline-content {
    margin-left: 0.625rem;
    .timeline-card {
      margin-bottom: 0.25rem;
      margin-top: 2.5rem;
      .date-tab {
        position: absolute;
        top: -23px;
        left: -2px;
        padding: 0 $component-padding;
        border-radius: 6px 6px 0 0;
        font-family: "KingsBureauGrot";
        line-height: 1.4;
        color: $headings;
        border: $print-component-border;
        border-bottom: none;
      }
      .card-body {
        width: 100% !important;
        .row {
          margin: 0;
          .col-md,
          .col-md-3 {
            margin: 0;
          }
          .col-md-3 img {
            max-width: 100%;
            height: auto;
          }
          .col-md {
            h3, h4, h5, h6 {
              line-height: 1.4;
              font-size: 1.125rem;
            }
            &:not(:first-child) {
              margin-left: $component-margin;
            }
          }
        }
        .img-reference {
          text-align: right;
        }
      }
    }
  }
  &.highlighted  {
    .timeline-badge-pill,
    .timeline-content .timeline-card .date-tab,
    .timeline-content .timeline-card {
      background-color: #ffe1d2;
    }
  }
  // Timeline (v2.5+)
  .timeline-2021-container {
    margin-top: 0;
    margin-bottom: $component-margin;
    .timeline-card {
      display: flex;
      justify-content: space-between;
      position: relative;
      border: $print-component-border;
      border-style: dashed;
      margin-bottom: 2.25rem;
      padding: $component-padding;
      &:not(:first-child) {
        &::before {
          position: absolute;
          content: "";
          border: 2px solid $slate-grey;
          border-width: 0 2px;
          height: 2.5rem;
          top: -2.5rem;
          left: 4.5rem;
        }
      }
      &:last-child {
        margin-bottom: 0;
      }
      &.highlighted {
        border: 4px solid $slate-grey;
        &:not(:first-child)::before {
          top: calc(-2.5rem - 2px);
        }
      }
      .date-label {
        line-height: 1;
        font-family: OpenSans, sans-serif;
        font-size: 1rem;
        font-weight: bold !important;
        color: $white !important;
        background-color: $slate-grey !important;
        padding: 0.5rem;
        width: fit-content;
      }
      .card-body {
        flex: 1;
        .card-title {
          margin-bottom: 0.75rem;
        }
        &:only-child > :last-child {
          margin-bottom: 0;
        }
      }
      .card-image {
        margin: 0 0 0 $component-margin;
        order: 2;
        max-width: 130px;
        img {
          width: 100%;
          margin-bottom: 0.5rem;
        }
      }
    }
  }

  // Transcript
  .transcript-container {
    display: inline-block;
    margin-bottom: $component-margin;
    position: relative;
    // transcript not associated with audio/video embed
    // such as within media-box info-box
    &::before {
      @extend %h5;
      content: "Transcript";
      position: absolute;
      top: 4px;
      left: $component-margin;
    }
    &::after {
      position: absolute;
      top: 4px;
      left: $component-margin;
    }
    .transcript-button-group {
      display: none;
    }
    .transcript-card {
      .card-body {
        border-left: $print-component-border;
        padding-left: $component-padding;
        // heading height + mimic bottom margin
        padding-top: 46px;
      }
    }
  }
  // video/audio embed with transcript
  .embed-responsive, .audio-container {
    & + .transcript-container {
      // icon width
      margin-left: 40px;
      &::before {
        @extend %print-icon-before;
        position: absolute;
        left: -40px;
        width: 40px;
        display: flex;
        justify-content: center;
      }
    }
  }
  // video
  .embed-responsive + .transcript-container {
    &::before {
      @include fa-content($fa-play-circle);
      font-size: 24px;
    }
    &::after {
      content: "Video transcript";
    }
  }
  // audio
  .audio-container + .transcript-container {
    &::before {
      @include fa-content($fa-microphone-alt);
      font-size: 28px;
    }
    &::after {
      content: "Audio transcript";
    }
  }

  // View answer and Academic note
  .view-generic-container,
  .view-answer-container,
  .view-description-container,
  .view-feedback-container,
  .view-model-answer-container,
  .academic-note-container {
    margin-bottom: $component-margin-bottom;
    & > h3, & > h4, & > h5, & > h6, & > p {
      font-size: 1.2rem;
      margin-left: calc(150px + #{$component-margin});
      border-left: $print-component-border;
      padding-left: $component-padding;
      margin-bottom:  0;
      padding-bottom: $component-margin;
    }
    // hide button
    [class*="view-hide-"] {
      display: none;
    }
    [class*="-card"] > .card-body {
      display: flex;
      border: none;
      .card-author {
        text-align: center;
        border-right: $print-component-border;
        padding-right: $component-padding;
        & > img,
        & > .filter-ally-wrapper > img {
          border-radius: 50%;
          width: 150px;
          max-width: 150px !important;
          height: auto;
          margin: 0 0 0.625rem 0;
        }
        .card-title {
          max-width: 150px;
        }
      }
      & > .card-text {
        & > :last-child {
          margin-bottom: 0;
        }
      }
      & .card-text:only-child,
      & > p {
        border-left: $print-component-border;
        padding-left: $component-padding;
      }
    }
  }
  // large margin left for all but view description card text
  .view-generic-container,
  .view-answer-container,
  .view-feedback-container,
  .view-model-answer-container,
  .academic-note-container {
    [class*="-card"] > .card-body {
      & > .card-text {
        margin-left: $component-margin;
      }
      & .card-text:only-child,
      & > p {
        margin-left: calc(150px + #{$component-margin});
        max-width: calc(100% - 150px - #{$component-margin});
      }
    }
  }
  .float-box {
    .view-generic-container,
    .view-answer-container,
    .view-description-container,
    .view-feedback-container,
    .view-model-answer-container,
    .academic-note-container {
      margin-top: $component-margin-sm;
      border-left: $print-component-border;
      padding-left: $component-padding;
      & > h3, & > h4, & > h5, & > h6 {
        margin-left: 0;
        border: none;
        padding-left: 0;
      }
      [class*="-card"] > .card-body {
        display: block;
        .card-author {
          width: 150px;
        }
        & > h3, & > h4, & > h5, & > h6,
        & > h3, & > h4, & > h5, & > h6,
        & > img,
        & > .filter-ally-wrapper > img,
        .card-author,
        .card-text,
        & > p {
          margin-left: 0 !important;
          border: none !important;
          padding-left: 0 !important;
          max-width: 100% !important;
        }
      }
    }
  }
}

/* print */
@media print {
  .book {
    .book_title {
      margin-top: 0 !important;
      // large margin to prevent overlap with print button
      h1:first-of-type {
        margin-top: 0 !important;
      }
    }
  }
  // View answer and Academic note
  // no idea why but image needs to be twice as big for print than
  // print-preview to occupy the same space
  .view-generic-container,
  .view-answer-container,
  .view-description-container,
  .view-feedback-container,
  .view-model-answer-container,
  .academic-note-container {
    [class*="-card"] > .card-body {
      .card-author {
        & > img,
        & > .filter-ally-wrapper > img {
          width: 300px !important;
        }
      }
    }
  }
}
